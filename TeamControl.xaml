<UserControl x:Class="Einsatzueberwachung.TeamControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:fa="http://schemas.fontawesome.io/icons/"
             x:Name="TeamControlRoot">

    <UserControl.Resources>
        <!-- KOMPAKTE Professional Team Card Style -->
        <Style x:Key="TeamCard" TargetType="Border" BasedOn="{StaticResource CardElevated}">
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="MinHeight" Value="280"/>
        </Style>
        
        <!-- KOMPAKTE Enhanced Timer Button -->
        <Style x:Key="TimerButton" TargetType="Button" BasedOn="{StaticResource FilledButton}">
            <Setter Property="Width" Value="85"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Padding" Value="8,6"/>
        </Style>

        <!-- KOMPAKTE Icon Button for Delete -->
        <Style x:Key="DeleteButton" TargetType="Button" BasedOn="{StaticResource FAB}">
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Background" Value="{DynamicResource Error}"/>
        </Style>

        <!-- KOMPAKTE Team Type Badge -->
        <Style x:Key="TeamTypeBadge" TargetType="Button" BasedOn="{StaticResource TextButton}">
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>

        <!-- KOMPAKTE Enhanced Input Field -->
        <Style x:Key="TeamTextField" TargetType="TextBox" BasedOn="{StaticResource TextField}">
            <Setter Property="Margin" Value="0,0,0,6"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="8,6"/>
        </Style>

        <!-- KOMPAKTE Professional Label -->
        <Style x:Key="TeamLabel" TargetType="Label">
            <Setter Property="Foreground" Value="{DynamicResource OnSurfaceVariant}"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Margin" Value="0,4,0,2"/>
            <Setter Property="Padding" Value="0"/>
        </Style>

        <!-- Enhanced Animations -->
        <Storyboard x:Key="BlinkingAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="1.0" To="0.3" Duration="0:0:0.8" AutoReverse="True"/>
        </Storyboard>

        <Storyboard x:Key="WarningPulse" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="1.0" To="0.5" Duration="0:0:0.8" AutoReverse="True"/>
        </Storyboard>

        <Storyboard x:Key="CardEntrance">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.6"/>
            <DoubleAnimation Storyboard.TargetProperty="(RenderTransform).(ScaleTransform.ScaleX)"
                           From="0.9" To="1" Duration="0:0:0.6"/>
            <DoubleAnimation Storyboard.TargetProperty="(RenderTransform).(ScaleTransform.ScaleY)"
                           From="0.9" To="1" Duration="0:0:0.6"/>
        </Storyboard>
        
        <!-- Alias for CardEntrance to match code reference -->
        <Storyboard x:Key="CardEntranceAnimation" RepeatBehavior="1x">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.6"/>
            <DoubleAnimation Storyboard.TargetProperty="(RenderTransform).(ScaleTransform.ScaleX)"
                           From="0.9" To="1" Duration="0:0:0.6"/>
            <DoubleAnimation Storyboard.TargetProperty="(RenderTransform).(ScaleTransform.ScaleY)"
                           From="0.9" To="1" Duration="0:0:0.6"/>
        </Storyboard>
    </UserControl.Resources>

    <Border x:Name="TeamBorder" Style="{StaticResource TeamCard}"
            RenderTransformOrigin="0.5,0.5">
        
        <Border.RenderTransform>
            <ScaleTransform ScaleX="1" ScaleY="1"/>
        </Border.RenderTransform>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- 🏷️ KOMPAKTER Team Header -->
            <Grid Grid.Row="0" Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Team Info & Status -->
                <StackPanel Grid.Column="0">
                    <!-- Warning Indicator & Team Name in ONE LINE -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                        <Border x:Name="WarningIndicator" 
                               Width="12" Height="12" CornerRadius="6" 
                               Background="Transparent" 
                               VerticalAlignment="Center" 
                               Margin="0,0,8,0"/>

                        <TextBlock x:Name="TeamNameText"
                                  Text="{Binding TeamName, ElementName=TeamControlRoot}" 
                                  FontSize="18"
                                  FontWeight="Bold"
                                  Foreground="{DynamicResource OnSurface}"
                                  VerticalAlignment="Center"/>
                                  
                        <TextBlock x:Name="WarningStatusText"
                                  FontSize="14"
                                  FontWeight="Bold"
                                  Margin="8,0,0,0"
                                  VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Team Type Badge & Warning Settings HORIZONTAL -->
                    <StackPanel Orientation="Horizontal">
                        <!-- Team Type Badge -->
                        <Button x:Name="TeamTypeBadgeButton" 
                               Style="{StaticResource TeamTypeBadge}"
                               Click="TeamTypeBadgeButton_Click"
                               ToolTip="Spezialisierung bearbeiten"
                               Margin="0,0,6,0">
                            <Border x:Name="TeamTypeBadge" 
                                   Background="{DynamicResource Primary}"
                                   CornerRadius="12" Padding="10,4">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock x:Name="TeamTypeText"
                                              Foreground="White" 
                                              FontSize="12"/>
                                    <fa:ImageAwesome Icon="Edit" Width="10" Height="10" 
                                                   Foreground="White" Margin="6,0,0,0" Opacity="0.8"/>
                                </StackPanel>
                            </Border>
                        </Button>

                        <!-- Warnschwellen-Button -->
                        <Button x:Name="BtnWarningSettings" 
                               Style="{StaticResource TeamTypeBadge}"
                               Click="BtnWarningSettings_Click"
                               ToolTip="Warnschwellen">
                            <Border Background="{DynamicResource Warning}"
                                   CornerRadius="12" Padding="10,4">
                                <StackPanel Orientation="Horizontal">
                                    <fa:ImageAwesome Icon="ClockOutline" Width="10" Height="10" 
                                                   Foreground="White" Margin="0,0,6,0"/>
                                    <TextBlock x:Name="WarningSettingsText"
                                              Foreground="White" 
                                              FontSize="12"/>
                                </StackPanel>
                            </Border>
                        </Button>
                    </StackPanel>
                </StackPanel>

                <!-- Delete Button -->
                <Button x:Name="BtnDeleteTeam" Grid.Column="1" 
                       Click="BtnDeleteTeam_Click"
                       Style="{StaticResource DeleteButton}"
                       ToolTip="Team löschen" 
                       VerticalAlignment="Top">
                    <fa:ImageAwesome Icon="Trash" Width="14" Height="14" Foreground="White"/>
                </Button>
            </Grid>

            <!-- ⏱️ KOMPAKTER Timer Section -->
            <Border Grid.Row="1" Style="{StaticResource Card}"
                   Background="{DynamicResource SurfaceVariant}"
                   Margin="0,0,0,12" Padding="12">
                <StackPanel>
                    <!-- Timer Display -->
                    <TextBlock x:Name="TimerDisplay" 
                              Text="{Binding ElapsedTimeString, ElementName=TeamControlRoot}" 
                              FontSize="32"
                              FontWeight="Bold"
                              Foreground="{DynamicResource Primary}"
                              HorizontalAlignment="Center" 
                              FontFamily="Consolas"
                              Margin="0,0,0,8"/>
                    
                    <!-- Timer Controls -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <Button x:Name="BtnStart" Click="BtnStart_Click"
                               Style="{StaticResource TimerButton}" 
                               Background="{DynamicResource Success}">
                            <StackPanel Orientation="Horizontal">
                                <fa:ImageAwesome Icon="Play" Width="12" Height="12" 
                                               Margin="0,0,4,0" Foreground="White"/>
                                <TextBlock Text="Start" Foreground="White" FontSize="13"/>
                            </StackPanel>
                        </Button>
                        
                        <Button x:Name="BtnStop" Click="BtnStop_Click"
                               Style="{StaticResource TimerButton}" 
                               Background="{DynamicResource Warning}">
                            <StackPanel Orientation="Horizontal">
                                <fa:ImageAwesome Icon="Stop" Width="12" Height="12" 
                                               Margin="0,0,4,0" Foreground="White"/>
                                <TextBlock Text="Stop" Foreground="White" FontSize="13"/>
                            </StackPanel>
                        </Button>
                        
                        <Button x:Name="BtnReset" Click="BtnReset_Click"
                               Style="{StaticResource TimerButton}" 
                               Background="{DynamicResource Error}">
                            <StackPanel Orientation="Horizontal">
                                <fa:ImageAwesome Icon="Refresh" Width="12" Height="12" 
                                               Margin="0,0,4,0" Foreground="White"/>
                                <TextBlock Text="Reset" Foreground="White" FontSize="13"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- 👥 KOMPAKTE Team Information - 2 SPALTEN -->
            <Grid Grid.Row="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Dog Information -->
                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,4,0">
                    <Label Style="{StaticResource TeamLabel}">
                        <StackPanel Orientation="Horizontal">
                            <fa:ImageAwesome Icon="Paw" Width="12" Height="12" 
                                           Foreground="{DynamicResource OnSurfaceVariant}" Margin="0,0,4,0"/>
                            <TextBlock Text="Hund" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Label>
                    <TextBox x:Name="TxtHund" 
                            Text="{Binding HundName, ElementName=TeamControlRoot, UpdateSourceTrigger=PropertyChanged}"
                            Style="{StaticResource TeamTextField}"/>
                </StackPanel>

                <!-- Handler Information -->
                <StackPanel Grid.Row="0" Grid.Column="1" Margin="4,0,0,0">
                    <Label Style="{StaticResource TeamLabel}">
                        <StackPanel Orientation="Horizontal">
                            <fa:ImageAwesome Icon="User" Width="12" Height="12" 
                                           Foreground="{DynamicResource OnSurfaceVariant}" Margin="0,0,4,0"/>
                            <TextBlock Text="Hundeführer" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Label>
                    <TextBox x:Name="TxtHundefuehrer" 
                            Text="{Binding Hundefuehrer, ElementName=TeamControlRoot, UpdateSourceTrigger=PropertyChanged}"
                            Style="{StaticResource TeamTextField}"/>
                </StackPanel>

                <!-- Helpers Information -->
                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,4,0">
                    <Label Style="{StaticResource TeamLabel}">
                        <StackPanel Orientation="Horizontal">
                            <fa:ImageAwesome Icon="Users" Width="12" Height="12" 
                                           Foreground="{DynamicResource OnSurfaceVariant}" Margin="0,0,4,0"/>
                            <TextBlock Text="Helfer" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Label>
                    <TextBox x:Name="TxtHelfer" 
                            Text="{Binding Helfer, ElementName=TeamControlRoot, UpdateSourceTrigger=PropertyChanged}"
                            Style="{StaticResource TeamTextField}"/>
                </StackPanel>

                <!-- Suchgebiet -->
                <StackPanel Grid.Row="1" Grid.Column="1" Margin="4,0,0,0">
                    <Label Style="{StaticResource TeamLabel}">
                        <StackPanel Orientation="Horizontal">
                            <fa:ImageAwesome Icon="MapMarker" Width="12" Height="12" 
                                           Foreground="{DynamicResource OnSurfaceVariant}" Margin="0,0,4,0"/>
                            <TextBlock Text="Suchgebiet" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Label>
                    <TextBox x:Name="TxtSuchgebiet" 
                            Text="{Binding Suchgebiet, ElementName=TeamControlRoot, UpdateSourceTrigger=PropertyChanged}"
                            Style="{StaticResource TeamTextField}"
                            ToolTip="Suchgebiet (z.B. Sektor A)"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</UserControl>
