<Window x:Class="Einsatzueberwachung.Views.TeamTypeSelectionWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:fa="http://schemas.fontawesome.io/icons/"
        Title="{Binding WindowTitle}" Height="771" Width="460"
        WindowStartupLocation="CenterOwner"
        Icon="pack://application:,,,/Resources/app.ico"
        ResizeMode="NoResize"
        Background="{DynamicResource SurfaceContainer}">

    <Window.Resources>
        <!-- Orange-Enhanced Team Type CheckBox Design -->
        <Style x:Key="TeamTypeSelectionCard" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource Surface}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Outline}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
            <Setter Property="Effect" Value="{StaticResource Elevation1}"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsSelected}" Value="True">
                    <Setter Property="BorderBrush" Value="{DynamicResource Primary}"/>
                    <Setter Property="BorderThickness" Value="3"/>
                    <Setter Property="Effect" Value="{StaticResource Elevation3}"/>
                </DataTrigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="{DynamicResource Primary}"/>
                    <Setter Property="BorderThickness" Value="2"/>
                    <Setter Property="Effect" Value="{StaticResource Elevation2}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="TeamTypeCheckBox" TargetType="CheckBox">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Border Style="{StaticResource TeamTypeSelectionCard}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Type Color Indicator -->
                                <Border Grid.Column="0" Width="24" Height="24" CornerRadius="12" 
                                       Background="{Binding ColorBrush}" 
                                       Margin="0,0,12,0" VerticalAlignment="Center">
                                    <Border.Effect>
                                        <DropShadowEffect Color="Black" BlurRadius="4" ShadowDepth="1" Opacity="0.3"/>
                                    </Border.Effect>
                                </Border>
                                
                                <!-- Content -->
                                <ContentPresenter Grid.Column="1" VerticalAlignment="Center"/>
                                
                                <!-- Selection Indicator with Orange Theme -->
                                <Border Grid.Column="2" x:Name="SelectionIndicator"
                                       Width="32" Height="32" CornerRadius="16"
                                       Background="{DynamicResource Primary}"
                                       Visibility="Collapsed">
                                    <fa:FontAwesome Icon="Check" FontSize="16" 
                                                   Foreground="{DynamicResource OnPrimary}"/>
                                </Border>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="SelectionIndicator" Property="Visibility" Value="Visible"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Orange Header Section -->
        <Border Grid.Row="0" Style="{StaticResource Card}" Margin="0,0,0,20">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="{DynamicResource PrimaryColor}" Offset="0"/>
                    <GradientStop Color="{DynamicResource PrimaryContainerColor}" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <!-- Icon -->
                <Border Width="56" Height="56" CornerRadius="28" 
                       Background="{DynamicResource OnPrimary}" Margin="0,0,16,0">
                    <fa:FontAwesome Icon="Certificate" FontSize="28" 
                                   Foreground="{DynamicResource Primary}"/>
                </Border>
                
                <!-- Title -->
                <StackPanel VerticalAlignment="Center">
                    <TextBlock Text="Team-Spezialisierungen" FontSize="24" FontWeight="Bold"
                              Foreground="{DynamicResource OnPrimary}"/>
                    <TextBlock Text="Wählen Sie eine oder mehrere Spezialisierungen aus" FontSize="14"
                              Foreground="{DynamicResource OnPrimary}" Opacity="0.8"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Information Panel -->
        <Border Grid.Row="1" Style="{StaticResource Card}" 
               Background="{DynamicResource PrimaryContainer}"
               BorderBrush="{DynamicResource Primary}" BorderThickness="1"
               Margin="0,0,0,20">
            <StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <fa:FontAwesome Icon="InfoCircle" FontSize="16" 
                                   Foreground="{DynamicResource Primary}" Margin="0,0,8,0"/>
                    <TextBlock Text="Auswahlregeln" FontSize="16" FontWeight="SemiBold"
                              Foreground="{DynamicResource OnPrimaryContainer}"/>
                </StackPanel>

                <TextBlock TextWrapping="Wrap" FontSize="13"
                          Foreground="{DynamicResource OnPrimaryContainer}" LineHeight="18">
                    <Run Text="• Mindestens eine Spezialisierung muss ausgewählt werden"/>
                    <LineBreak/>
                    <Run Text="• Mehrfachauswahl möglich für kombinierte Teams"/>
                    <LineBreak/>
                    <Run Text="• Farb-Kodierung zeigt die Team-Kategorie an"/>
                </TextBlock>
            </StackPanel>
        </Border>

        <!-- Team Type Selection List -->
        <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" Margin="0,0,0,20">
            <ItemsControl ItemsSource="{Binding TeamTypeItems}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                 Style="{StaticResource TeamTypeCheckBox}"
                                 DataContext="{Binding}">
                            <StackPanel>
                                <TextBlock Text="{Binding DisplayName}" 
                                          FontWeight="Medium" FontSize="15"
                                          Foreground="{DynamicResource OnSurface}"/>
                                <TextBlock Text="{Binding Description}" 
                                          FontSize="12" TextWrapping="Wrap"
                                          Foreground="{DynamicResource OnSurfaceVariant}"
                                          Margin="0,2,0,0"/>
                            </StackPanel>
                        </CheckBox>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- Selection Summary -->
        <Border Grid.Row="3" Style="{StaticResource Card}" 
               Background="{DynamicResource SurfaceVariant}"
               Margin="0,0,0,20">
            <StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <fa:FontAwesome Icon="List" FontSize="16" 
                                   Foreground="{DynamicResource Primary}" Margin="0,0,8,0"/>
                    <TextBlock Text="Aktuelle Auswahl:" FontSize="16" FontWeight="SemiBold"
                              Foreground="{DynamicResource OnSurface}"/>
                </StackPanel>
                
                <TextBlock Text="{Binding SelectedTypesDisplayText}" 
                          FontSize="14" TextWrapping="Wrap"
                          Foreground="{DynamicResource OnSurfaceVariant}"/>
            </StackPanel>
        </Border>

        <!-- Action Buttons with Orange Styling -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Center">
            <Button Command="{Binding ClearAllCommand}" 
                   Width="120" Height="40" Margin="0,0,12,0"
                   Style="{StaticResource OutlinedButton}">
                <StackPanel Orientation="Horizontal">
                    <fa:FontAwesome Icon="Times" FontSize="14" Margin="0,0,6,0"/>
                    <TextBlock Text="Alle löschen"/>
                </StackPanel>
            </Button>
               
            <Button Command="{Binding CancelCommand}" 
                   Width="120" Height="40" Margin="12,0"
                   Style="{StaticResource OutlinedButton}">
                <StackPanel Orientation="Horizontal">
                    <fa:FontAwesome Icon="Ban" FontSize="14" Margin="0,0,6,0"/>
                    <TextBlock Text="Abbrechen"/>
                </StackPanel>
            </Button>
               
            <Button Command="{Binding OkCommand}" 
                   IsEnabled="{Binding IsOkButtonEnabled}"
                   Width="140" Height="40" Margin="12,0,0,0"
                   Style="{StaticResource FilledButton}">
                <StackPanel Orientation="Horizontal">
                    <fa:FontAwesome Icon="Check" FontSize="14" Margin="0,0,6,0"/>
                    <TextBlock Text="Bestätigen"/>
                </StackPanel>
            </Button>
        </StackPanel>
    </Grid>
</Window>
